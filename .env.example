# ============================================
# LegacyGuard - Configuração de Ambiente
# ============================================
# Copie este arquivo para .env.local e preencha os valores

# ============ OBRIGATÓRIOS EM PRODUÇÃO ============

# OpenAI API
OPENAI_API_KEY=sk-...

# Redis (fila de tarefas e streams)
# Use REDIS_TLS_URL para conexões seguras (recomendado em produção)
REDIS_URL=redis://:password@your-redis-host:6379
REDIS_TLS_URL=rediss://:password@your-redis-host:6379

# NextAuth
NEXTAUTH_SECRET=gere-uma-chave-secreta-com-openssl-rand-base64-32
NEXTAUTH_URL=https://seu-dominio.com

# GitHub OAuth (para login)
GITHUB_ID=seu-github-client-id
GITHUB_SECRET=seu-github-client-secret

# ============ BANCO DE DADOS ============

# PostgreSQL para audit logs e quotas (recomendado em produção)
# Se não configurado, usa armazenamento em memória (dados perdidos no restart)
AUDIT_DB_URL=postgres://user:pass@host:5432/legacyguard

# PostgreSQL com pgvector para RAG/embeddings (opcional)
# Pode ser o mesmo que AUDIT_DB_URL se suportar pgvector
PGVECTOR_URL=postgres://user:pass@host:5432/legacyguard

# Chave para assinar logs de auditoria
AUDIT_SIGNING_KEY=gere-uma-chave-secreta

# ============ MODELOS LLM ============

# Modelos OpenAI (opcional - tem defaults)
OPENAI_CHEAP_MODEL=gpt-4o-mini
OPENAI_DEEP_MODEL=gpt-4o

# Limite de tokens por request
MAX_TOKENS_PER_REQUEST=50000

# ============ SANDBOX (Execução Segura) ============

# Habilitar execução de código em sandbox Docker
LEGACYGUARD_SANDBOX_ENABLED=true

# Caminho do repositório para análise
LEGACYGUARD_REPO_PATH=/app/repo

# Comando de teste padrão
LEGACYGUARD_SANDBOX_COMMAND=npm test

# Script runner personalizado
LEGACYGUARD_SANDBOX_RUNNER=/app/scripts/runner_sandbox.sh

# Timeout em ms (padrão: 15 min)
LEGACYGUARD_SANDBOX_TIMEOUT_MS=900000

# Modo de falha: 'fail' (bloqueia) ou 'warn' (continua)
LEGACYGUARD_SANDBOX_FAIL_MODE=fail

# Forçar uso de Docker mesmo sem verificação
LEGACYGUARD_FORCE_DOCKER=false

# ============ QUOTAS E LIMITES ============

# Threshold de custo para circuit breaker (USD)
QUOTA_CIRCUIT_THRESHOLD_USD=1000

# Pausa do circuit breaker em ms (10 min)
QUOTA_CIRCUIT_PAUSE_MS=600000

# ============ MODO DESENVOLVIMENTO ============

# Força modo mock nos agentes (não usar em produção!)
# LEGACYGUARD_PLANNER_MODE=mock
# LEGACYGUARD_REVIEWER_MODE=mock

NODE_ENV=production
